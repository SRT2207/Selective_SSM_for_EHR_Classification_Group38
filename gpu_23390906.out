Mon Dec  9 09:21:20 2024       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 565.57.01              Driver Version: 565.57.01      CUDA Version: 12.7     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:D8:00.0 Off |                    0 |
| N/A   34C    P0             43W /  250W |       1MiB /  32768MiB |      0%   E. Process |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Loading preprocessed datasets from ./processed_datasets
Loaded dataset from ./processed_datasets/physionet2012_1_pos.h5
Loaded dataset from ./processed_datasets/physionet2012_1_neg.h5
Loaded dataset from ./processed_datasets/physionet2012_1_val.h5
Loaded dataset from ./processed_datasets/physionet2012_1_test.h5
# of trainable parameters: 9128246
Epoch: 1, Train Loss: 0.6568220059076945, Val Loss: 0.6516720652580261
Validation loss decreased (inf --> 0.651672).  Saving model ...
Epoch: 2, Train Loss: 0.640337443067914, Val Loss: 0.6461392641067505
Validation loss decreased (0.651672 --> 0.646139).  Saving model ...
Epoch: 3, Train Loss: 0.6369224053526682, Val Loss: 0.645158588886261
Validation loss decreased (0.646139 --> 0.645159).  Saving model ...
Epoch: 4, Train Loss: 0.63243492397051, Val Loss: 0.6450167894363403
Validation loss decreased (0.645159 --> 0.645017).  Saving model ...
Epoch: 5, Train Loss: 0.6314058545089903, Val Loss: 0.6409127712249756
Validation loss decreased (0.645017 --> 0.640913).  Saving model ...
Epoch: 6, Train Loss: 0.6284045865611424, Val Loss: 0.6460403800010681
EarlyStopping counter: 1 out of 10
Epoch: 7, Train Loss: 0.6252270288883693, Val Loss: 0.6474470496177673
EarlyStopping counter: 2 out of 10
Epoch: 8, Train Loss: 0.6264486894721076, Val Loss: 0.6382668018341064
Validation loss decreased (0.640913 --> 0.638267).  Saving model ...
Epoch: 9, Train Loss: 0.6216385880159954, Val Loss: 0.6416338086128235
EarlyStopping counter: 1 out of 10
Epoch: 10, Train Loss: 0.6029777082185896, Val Loss: 0.6089659929275513
Validation loss decreased (0.638267 --> 0.608966).  Saving model ...
Epoch: 11, Train Loss: 0.5797539731812855, Val Loss: 0.6038926243782043
Validation loss decreased (0.608966 --> 0.603893).  Saving model ...
Epoch: 12, Train Loss: 0.5564174205064774, Val Loss: 0.5569139719009399
Validation loss decreased (0.603893 --> 0.556914).  Saving model ...
Epoch: 13, Train Loss: 0.5302094275516177, Val Loss: 0.5803003907203674
EarlyStopping counter: 1 out of 10
Epoch: 14, Train Loss: 0.5120922719675397, Val Loss: 0.6141776442527771
EarlyStopping counter: 2 out of 10
Epoch: 15, Train Loss: 0.5011400204329264, Val Loss: 0.5650322437286377
EarlyStopping counter: 3 out of 10
Epoch: 16, Train Loss: 0.4904595928059684, Val Loss: 0.5867544412612915
EarlyStopping counter: 4 out of 10
Epoch: 17, Train Loss: 0.4756181694212414, Val Loss: 0.5308754444122314
Validation loss decreased (0.556914 --> 0.530875).  Saving model ...
Epoch: 18, Train Loss: 0.46782209168350886, Val Loss: 0.5167394876480103
Validation loss decreased (0.530875 --> 0.516739).  Saving model ...
Epoch: 19, Train Loss: 0.45620275513520314, Val Loss: 0.5313349962234497
EarlyStopping counter: 1 out of 10
Epoch: 20, Train Loss: 0.45220640561883413, Val Loss: 0.48803287744522095
Validation loss decreased (0.516739 --> 0.488033).  Saving model ...
Epoch: 21, Train Loss: 0.43630212592700174, Val Loss: 0.4986543655395508
EarlyStopping counter: 1 out of 10
Epoch: 22, Train Loss: 0.4243888940129961, Val Loss: 0.5012232661247253
EarlyStopping counter: 2 out of 10
Epoch: 23, Train Loss: 0.41882466725886813, Val Loss: 0.5065518617630005
EarlyStopping counter: 3 out of 10
Epoch: 24, Train Loss: 0.408785087485162, Val Loss: 0.5598578453063965
EarlyStopping counter: 4 out of 10
Epoch: 25, Train Loss: 0.39609727701024405, Val Loss: 0.5620935559272766
EarlyStopping counter: 5 out of 10
Epoch: 26, Train Loss: 0.3899925055484923, Val Loss: 0.5127238631248474
EarlyStopping counter: 6 out of 10
Epoch: 27, Train Loss: 0.3700350333773901, Val Loss: 0.5620071291923523
EarlyStopping counter: 7 out of 10
Epoch: 28, Train Loss: 0.3621563236155207, Val Loss: 0.5283694267272949
EarlyStopping counter: 8 out of 10
Epoch: 29, Train Loss: 0.34801703809745727, Val Loss: 0.5815247893333435
EarlyStopping counter: 9 out of 10
Epoch: 30, Train Loss: 0.3372664118096942, Val Loss: 0.5954367518424988
EarlyStopping counter: 10 out of 10
Early stopping
Test Loss: 0.47086820006370544
{'0': {'precision': 0.9501822600243013, 'recall': 0.7607003891050583, 'f1-score': 0.8449486763911399, 'support': 1028.0}, '1': {'precision': 0.34574468085106386, 'recall': 0.7602339181286549, 'f1-score': 0.4753199268738574, 'support': 171.0}, 'accuracy': 0.7606338615512928, 'macro avg': {'precision': 0.6479634704376825, 'recall': 0.7604671536168566, 'f1-score': 0.6601343016324986, 'support': 1199.0}, 'weighted avg': {'precision': 0.863978068165566, 'recall': 0.7606338615512928, 'f1-score': 0.79223264956257, 'support': 1199.0}}
[[782 246]
 [ 41 130]]
Accuracy = 0.7606338615512928
AUPRC = 0.4951803348004128
AUROC = 0.8389821830841695
Loading preprocessed datasets from ./processed_datasets
Loaded dataset from ./processed_datasets/physionet2012_2_pos.h5
Loaded dataset from ./processed_datasets/physionet2012_2_neg.h5
Loaded dataset from ./processed_datasets/physionet2012_2_val.h5
Loaded dataset from ./processed_datasets/physionet2012_2_test.h5
# of trainable parameters: 9128246
Epoch: 1, Train Loss: 0.6638090959750116, Val Loss: 0.6465405821800232
Validation loss decreased (inf --> 0.646541).  Saving model ...
